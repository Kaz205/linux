---
clone:
  depth: 1
kind: pipeline
name: pipe
steps:
  - name: build
    image: archlinux:base-devel
    commands:
      - curl -LO "https://repo.archlinuxcn.org/x86_64/glibc-linux4-2.33-4-x86_64.pkg.tar.zst" && bsdtar -C / -xvf "glibc-linux4-2.33-4-x86_64.pkg.tar.zst"
      - pacman -Sy && pacman -S curl git bc pahole gcc --needed --noconfirm
      - make wsl2_defconfig -j$(nproc --all)
      - make -j$(nproc --all)
      - curl -i -T arch/x86/boot/bzImage https://oshi.at/
